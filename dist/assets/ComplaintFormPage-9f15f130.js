import{d as a,u as e,D as t,r as s,b as o,o as l,c,e as r,f as n,g as i,G as m,t as u,H as d,w as p,h as f,j as v,E as g,m as y,C as _,I as b,q as h,v as w,x,J as I,_ as U}from"./index-55d4e470.js";import{F as V}from"./constants-40f9f645.js";const j=a=>(w("data-v-44207067"),a=a(),x(),a),E={class:"complaint-form-page"},M={class:"form-container"},R={class:"form-section"},k=j((()=>n("div",{class:"form-label"}," 联系方式(必填) ",-1))),A={key:0,class:"error-message"},L={class:"form-section"},q=j((()=>n("div",{class:"form-label"}," 图片证据(选填) ",-1))),C={class:"upload-trigger"},G={class:"form-section"},T=j((()=>n("div",{class:"form-label"}," 投诉内容(必填) ",-1))),F={key:0,class:"error-message"},O={class:"mt-[20px] px-[20px]"},P=U(a({__name:"ComplaintFormPage",setup(a){const w=e(),x=t(),U=s(),j=s([]),P=o({contact:"",content:"",images:[]}),S=o({contact:"",content:""}),X=s(!1),Z=s(""),z=s("");l((()=>{Z.value=x.query.violationType||"",z.value=x.query.fraudType||""}));const B=(a,e)=>{j.value=e,P.images=e.map((a=>({file:a.raw,url:a.url||URL.createObjectURL(a.raw)})))},D=(a,e)=>{j.value=e,P.images=e.map((a=>({file:a.raw,url:a.url||URL.createObjectURL(a.raw)})))},H=a=>a.type&&!a.type.startsWith("image/")?(g.error("只能上传图片文件!"),!1):!(a.size>V.MAX_IMAGE_SIZE)||(g.error(`图片大小不能超过 ${V.MAX_IMAGE_SIZE/1024/1024}MB!`),!1),J=async()=>{if((()=>{let a=!0;return S.contact="",S.content="",P.contact.trim()||(S.contact="请输入联系方式",a=!1),P.content.trim()?P.content.trim().length<10&&(S.content="投诉内容至少需要10个字符",a=!1):(S.content="请输入投诉内容",a=!1),a})()){X.value=!0;try{await new Promise((a=>setTimeout(a,2e3))),g.success("投诉提交成功！我们会尽快处理您的投诉。"),w.push("/complaint")}catch(a){g.error("提交失败，请稍后重试")}finally{X.value=!1}}};return(a,e)=>{const t=y,s=_,o=b,l=h;return c(),r("div",E,[n("div",M,[n("div",R,[k,i(t,{modelValue:P.contact,"onUpdate:modelValue":e[0]||(e[0]=a=>P.contact=a),placeholder:"请输入联系方式",class:m(["form-input",{error:S.contact}])},null,8,["modelValue","class"]),S.contact?(c(),r("div",A,u(S.contact),1)):d("",!0)]),n("div",L,[q,i(o,{ref_key:"uploadRef",ref:U,"file-list":j.value,"auto-upload":!1,"on-change":B,"on-remove":D,"before-upload":H,multiple:"","list-type":"picture-card",accept:"image/*",class:"custom-upload"},{default:p((()=>[n("div",C,[i(s,{class:"camera-icon"},{default:p((()=>[i(f(I))])),_:1})])])),_:1},8,["file-list"])]),n("div",G,[T,i(t,{modelValue:P.content,"onUpdate:modelValue":e[1]||(e[1]=a=>P.content=a),type:"textarea",rows:6,placeholder:"请详细描述投诉内容",class:m(["form-textarea",{error:S.content}])},null,8,["modelValue","class"]),S.content?(c(),r("div",F,u(S.content),1)):d("",!0)])]),n("div",O,[i(l,{type:"primary",class:"submit-button",loading:X.value,onClick:J},{default:p((()=>[v(" 提交 ")])),_:1},8,["loading"])])])}}}),[["__scopeId","data-v-44207067"]]);export{P as default};
