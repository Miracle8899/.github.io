import{M as e,cl as a,cm as l,d as s,b0 as t,a8 as o,r as i,A as c,c as r,$ as n,w as u,ax as d,f,H as p,h,G as b,am as k,I as v,e as y,X as g,j as w,t as m,F as _,g as x,ay as C,c5 as B,Q as S,cn as W,av as T,b as I,o as V,l as $,E,k as j,aB as q,m as A,n as M,q as R,s as U,v as F,x as G,_ as H}from"./index-9d598a61.js";const L=e({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:a(l),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:["light","dark"],default:"light"}}),Q={close:e=>e instanceof MouseEvent},X=s({name:"ElAlert"});const z=T(S(s({...X,props:L,emits:Q,setup(e,{emit:a}){const s=e,{Close:S}=W,T=t(),I=o("alert"),V=i(!0),$=c((()=>l[s.type])),E=c((()=>!(!s.description&&!T.default))),j=e=>{V.value=!1,a("close",e)};return(e,a)=>(r(),n(B,{name:h(I).b("fade"),persisted:""},{default:u((()=>[d(f("div",{class:p([h(I).b(),h(I).m(e.type),h(I).is("center",e.center),h(I).is(e.effect)]),role:"alert"},[e.showIcon&&h($)?(r(),n(h(b),{key:0,class:p([h(I).e("icon"),{[h(I).is("big")]:h(E)}])},{default:u((()=>[(r(),n(k(h($))))])),_:1},8,["class"])):v("v-if",!0),f("div",{class:p(h(I).e("content"))},[e.title||e.$slots.title?(r(),y("span",{key:0,class:p([h(I).e("title"),{"with-description":h(E)}])},[g(e.$slots,"title",{},(()=>[w(m(e.title),1)]))],2)):v("v-if",!0),h(E)?(r(),y("p",{key:1,class:p(h(I).e("description"))},[g(e.$slots,"default",{},(()=>[w(m(e.description),1)]))],2)):v("v-if",!0),e.closable?(r(),y(_,{key:2},[e.closeText?(r(),y("div",{key:0,class:p([h(I).e("close-btn"),h(I).is("customed")]),onClick:j},m(e.closeText),3)):(r(),n(h(b),{key:1,class:p(h(I).e("close-btn")),onClick:j},{default:u((()=>[x(h(S))])),_:1},8,["class"]))],64)):v("v-if",!0)],2)],2),[[C,V.value]])])),_:3},8,["name"]))}}),[["__file","alert.vue"]])),D=e=>(F("data-v-d65c2fa7"),e=e(),G(),e),J={class:"webhook-config-page"},K=D((()=>f("div",{class:"page-header"},[f("h1",{class:"page-title"},"机器人Webhook配置"),f("p",{class:"page-description"},"配置您的机器人webhook地址，用于接收通知消息")],-1))),N={class:"config-form"},O={key:0,class:"config-info"},P=D((()=>f("p",null,"您的webhook配置已保存，系统将使用此地址发送通知消息。",-1))),Y={class:"config-url"},Z=H(s({__name:"WebhookConfig",setup(e){const a=i(),l=i(!1),s=i(!1),t=i(!1),o=I({webhook_url:""}),c={webhook_url:[{required:!0,message:"请输入webhook地址",trigger:"blur"},{pattern:/^https?:\/\/.+/,message:"请输入有效的URL地址（以http://或https://开头）",trigger:"blur"}]};V((async()=>{await d()}));const d=async()=>{try{const e=await $.getWebhookConfig();o.webhook_url=(null==e?void 0:e.webhook_url)||"",t.value=!0}catch(e){E.error("加载配置失败")}},p=async()=>{if(a.value){try{await a.value.validate()}catch(e){return}l.value=!0;try{await $.saveWebhookConfig(o.webhook_url.trim());E.success("保存成功"),t.value=!0}catch(e){E.error("保存失败，请重试")}finally{l.value=!1}}},h=async()=>{try{await q.confirm("确定要删除webhook配置吗？删除后将无法接收通知消息。","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch{return}s.value=!0;try{await $.deleteWebhookConfig();E.success("删除成功"),o.webhook_url="",t.value=!1}catch(e){E.error("删除失败，请重试")}finally{s.value=!1}},b=()=>{o.webhook_url="",t.value=!1,a.value&&a.value.clearValidate()};return(e,i)=>{const d=A,k=M,g=R,_=U,C=z;return r(),y("div",J,[K,f("div",N,[x(_,{ref_key:"formRef",ref:a,model:o,rules:c,"label-width":"120px",onSubmit:j(p,["prevent"])},{default:u((()=>[x(k,{label:"Webhook地址",prop:"webhook_url"},{default:u((()=>[x(d,{modelValue:o.webhook_url,"onUpdate:modelValue":i[0]||(i[0]=e=>o.webhook_url=e),type:"textarea",rows:4,placeholder:"请输入完整的webhook地址，例如：https://hooks.slack.com/services/xxx/xxx/xxx",maxlength:"500","show-word-limit":"",clearable:""},null,8,["modelValue"])])),_:1}),x(k,null,{default:u((()=>[x(g,{type:"primary",onClick:p,loading:l.value,disabled:!o.webhook_url.trim()},{default:u((()=>[w(" 保存配置 ")])),_:1},8,["loading","disabled"]),t.value?(r(),n(g,{key:0,type:"danger",onClick:h,loading:s.value},{default:u((()=>[w(" 删除配置 ")])),_:1},8,["loading"])):v("",!0),x(g,{onClick:b},{default:u((()=>[w(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"])]),t.value?(r(),y("div",O,[x(C,{title:"配置已保存",type:"success",closable:!1,"show-icon":""},{default:u((()=>[P,f("p",Y,"当前配置："+m(o.webhook_url),1)])),_:1})])):v("",!0)])}}}),[["__scopeId","data-v-d65c2fa7"]]);export{Z as default};
