import{L as e,cl as a,cm as l,d as s,b0 as t,a8 as o,r as i,R as c,c as r,$ as n,w as u,ax as d,f,G as p,h,D as b,am as k,H as v,e as y,X as g,j as w,t as m,F as _,g as x,ay as C,c5 as B,P as S,cn as W,av as T,b as V,o as $,l as E,E as I,k as R,aB as j,m as q,n as L,q as U,s as A,v as D,x as F,_ as G}from"./index-62a62fdc.js";const H=e({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:a(l),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:["light","dark"],default:"light"}}),M={close:e=>e instanceof MouseEvent},P=s({name:"ElAlert"});const X=T(S(s({...P,props:H,emits:M,setup(e,{emit:a}){const s=e,{Close:S}=W,T=t(),V=o("alert"),$=i(!0),E=c((()=>l[s.type])),I=c((()=>!(!s.description&&!T.default))),R=e=>{$.value=!1,a("close",e)};return(e,a)=>(r(),n(B,{name:h(V).b("fade"),persisted:""},{default:u((()=>[d(f("div",{class:p([h(V).b(),h(V).m(e.type),h(V).is("center",e.center),h(V).is(e.effect)]),role:"alert"},[e.showIcon&&h(E)?(r(),n(h(b),{key:0,class:p([h(V).e("icon"),{[h(V).is("big")]:h(I)}])},{default:u((()=>[(r(),n(k(h(E))))])),_:1},8,["class"])):v("v-if",!0),f("div",{class:p(h(V).e("content"))},[e.title||e.$slots.title?(r(),y("span",{key:0,class:p([h(V).e("title"),{"with-description":h(I)}])},[g(e.$slots,"title",{},(()=>[w(m(e.title),1)]))],2)):v("v-if",!0),h(I)?(r(),y("p",{key:1,class:p(h(V).e("description"))},[g(e.$slots,"default",{},(()=>[w(m(e.description),1)]))],2)):v("v-if",!0),e.closable?(r(),y(_,{key:2},[e.closeText?(r(),y("div",{key:0,class:p([h(V).e("close-btn"),h(V).is("customed")]),onClick:R},m(e.closeText),3)):(r(),n(h(b),{key:1,class:p(h(V).e("close-btn")),onClick:R},{default:u((()=>[x(h(S))])),_:1},8,["class"]))],64)):v("v-if",!0)],2)],2),[[C,$.value]])])),_:3},8,["name"]))}}),[["__file","alert.vue"]])),z=e=>(D("data-v-d65c2fa7"),e=e(),F(),e),J={class:"webhook-config-page"},K=z((()=>f("div",{class:"page-header"},[f("h1",{class:"page-title"},"机器人Webhook配置"),f("p",{class:"page-description"},"配置您的机器人webhook地址，用于接收通知消息")],-1))),N={class:"config-form"},O={key:0,class:"config-info"},Q=z((()=>f("p",null,"您的webhook配置已保存，系统将使用此地址发送通知消息。",-1))),Y={class:"config-url"},Z=G(s({__name:"WebhookConfig",setup(e){const a=i(),l=i(!1),s=i(!1),t=i(!1),o=V({webhook_url:""}),c={webhook_url:[{required:!0,message:"请输入webhook地址",trigger:"blur"},{pattern:/^https?:\/\/.+/,message:"请输入有效的URL地址（以http://或https://开头）",trigger:"blur"}]};$((async()=>{await d()}));const d=async()=>{try{const e=await E.getWebhookConfig();o.webhook_url=(null==e?void 0:e.webhook_url)||"",t.value=!0}catch(e){I.error("加载配置失败")}},p=async()=>{if(a.value){try{await a.value.validate()}catch(e){return}l.value=!0;try{await E.saveWebhookConfig(o.webhook_url.trim());I.success("保存成功"),t.value=!0}catch(e){I.error("保存失败，请重试")}finally{l.value=!1}}},h=async()=>{try{await j.confirm("确定要删除webhook配置吗？删除后将无法接收通知消息。","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch{return}s.value=!0;try{await E.deleteWebhookConfig();I.success("删除成功"),o.webhook_url="",t.value=!1}catch(e){I.error("删除失败，请重试")}finally{s.value=!1}},b=()=>{o.webhook_url="",t.value=!1,a.value&&a.value.clearValidate()};return(e,i)=>{const d=q,k=L,g=U,_=A,C=X;return r(),y("div",J,[K,f("div",N,[x(_,{ref_key:"formRef",ref:a,model:o,rules:c,"label-width":"120px",onSubmit:R(p,["prevent"])},{default:u((()=>[x(k,{label:"Webhook地址",prop:"webhook_url"},{default:u((()=>[x(d,{modelValue:o.webhook_url,"onUpdate:modelValue":i[0]||(i[0]=e=>o.webhook_url=e),type:"textarea",rows:4,placeholder:"请输入完整的webhook地址，例如：https://hooks.slack.com/services/xxx/xxx/xxx",maxlength:"500","show-word-limit":"",clearable:""},null,8,["modelValue"])])),_:1}),x(k,null,{default:u((()=>[x(g,{type:"primary",onClick:p,loading:l.value,disabled:!o.webhook_url.trim()},{default:u((()=>[w(" 保存配置 ")])),_:1},8,["loading","disabled"]),t.value?(r(),n(g,{key:0,type:"danger",onClick:h,loading:s.value},{default:u((()=>[w(" 删除配置 ")])),_:1},8,["loading"])):v("",!0),x(g,{onClick:b},{default:u((()=>[w(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model"])]),t.value?(r(),y("div",O,[x(C,{title:"配置已保存",type:"success",closable:!1,"show-icon":""},{default:u((()=>[Q,f("p",Y,"当前配置："+m(o.webhook_url),1)])),_:1})])):v("",!0)])}}}),[["__scopeId","data-v-d65c2fa7"]]);export{Z as default};
