import{d as a,a as e,r as o,b as l,N as s,o as t,k as c,c as i,e as d,f as n,g as r,h as p,j as u,w as y,n as v,p as b,l as f,_ as h}from"./index-fb5e286d.js";const m=a=>(b("data-v-5a9a2db7"),a=a(),f(),a),g={class:"webhook-config-page"},I={class:"page-header"},w={class:"page-title"},_=m((()=>r("p",{class:"page-description"},"配置企业微信 corpId 和机器人 webhook 地址",-1))),k={class:"config-section"},x={class:"section-header"},C=m((()=>r("span",{class:"section-title"},"企业微信配置",-1))),V={class:"input-with-button"},j={class:"form-tip"},U=m((()=>r("span",null,"用于企业微信相关功能，可留空",-1))),W=h(a({__name:"WebhookConfig",setup(a){const b=e();o(),o();const f=o(!1),h=l({corpId:""}),m=o(""),W=s((()=>h.corpId!==m.value));o(!1),o(!1);const z=o(!1),N=l({webhook_url:""});t((async()=>{document.title="接入配置",q(),await B()}));const q=()=>{var a;const e=(null==(a=b.userInfo)?void 0:a.corpId)||"";h.corpId=e,m.value=e},A=async()=>{try{f.value=!0;const a=await c.updateCorpId(h.corpId);a&&a.user&&(b.setUserInfo(a.user),m.value=h.corpId),v.msg("corpId 保存成功",{icon:1})}catch(a){v.msg("保存失败，请重试",{icon:2})}finally{f.value=!1}},B=async()=>{try{const a=await c.getWebhookConfig();N.webhook_url=(null==a?void 0:a.webhook_url)||"",z.value=!!(null==a?void 0:a.webhook_url)}catch(a){}};return(a,e)=>{const o=i("lay-icon"),l=i("lay-input"),s=i("lay-button"),t=i("lay-form-item"),c=i("lay-form");return d(),n("div",g,[r("div",I,[r("h1",w,[p(o,{type:"layui-icon-set",style:{"font-size":"28px","margin-right":"10px"}}),u(" 接入配置 ")]),_]),r("div",k,[r("div",x,[p(o,{type:"layui-icon-user",class:"section-icon"}),C]),p(c,{model:h,"label-width":"140px"},{default:y((()=>[p(t,{label:"企业微信 corpId"},{default:y((()=>[r("div",V,[p(l,{modelValue:h.corpId,"onUpdate:modelValue":e[0]||(e[0]=a=>h.corpId=a),placeholder:"请输入企业微信 corpId（非必填）",disabled:f.value,"allow-clear":"",style:{flex:"1"}},null,8,["modelValue","disabled"]),p(s,{type:"primary",onClick:A,loading:f.value,disabled:!W.value,style:{"margin-left":"10px"}},{default:y((()=>[u(" 保存 ")])),_:1},8,["loading","disabled"])]),r("div",j,[p(o,{type:"layui-icon-tips"}),U])])),_:1})])),_:1},8,["model"])])])}}}),[["__scopeId","data-v-5a9a2db7"]]);export{W as default};
